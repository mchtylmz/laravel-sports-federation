/*!
 * oneui - v5.9.0
 * @author pixelcave - https://pixelcave.com
 * Copyright (c) 2024
 */
!function () {
    "use strict";

    class e {

        static initCalendar() {
            let e = new Date, t = e.getDate(), a = e.getMonth(), n = e.getFullYear();
            let routeEvents = $('#js-calendar').data('route');

            new FullCalendar.Calendar(document.getElementById("js-calendar"), {
                locale: 'tr',
                contentHeight: 640,
                aspectRatio: 1.25,
                themeSystem: "bootstrap5",
                firstDay: 1,
                editable: false,
                droppable: false,
                headerToolbar: {left: "title", right: "prev,next today dayGridMonth,timeGridWeek,listWeek"},
                titleFormat: { year: 'numeric', month: 'long', day: 'numeric' },
                //dayHeaderFormat: { weekday: 'short',  month: 'numeric', day: 'numeric' },
                buttonText: {
                    today: 'Bugün',
                    month: 'Bu Ay',
                    week: 'Bu Hafta',
                    day: 'Bugün',
                    list: 'Liste'
                },
                eventTimeFormat: { // like '14:30:00'
                    hour: '2-digit',
                    minute: '2-digit',
                    hour12: false
                },
                drop: false,
                allDaySlot: false,
                //slotDuration: '00:15:00',
                slotMinTime: '08:00:00',
                slotMaxTime: '22:00:00',
                allDaySlot: false,
                weekNumbers: true,
                weekText: 'H',
                weekTextLong: 'Hafta',
                navLinks: true,
                nowIndicator: true,
                dayMaxEventRows: 3,
                moreLinkContent: function (more) {
                    return more.shortText + ' etkinlik';
                },
                // events: routeEvents,
                events: {
                    url: routeEvents,
                    method: 'GET',
                    extraParams: {
                        value: Math.random()
                    },
                    failure: function() {
                        alert('Etkinlikler yüklenemedi!');
                    },
                    //color: 'white',   // a non-ajax option
                    //textColor: 'black' // a non-ajax option
                },
                eventClick: function (info) {
                    console.log('Event, ' , info.event);

                    var offcanvasRight = document.getElementById('offcanvasRight')
                    var bsOffcanvas = new bootstrap.Offcanvas(offcanvasRight);
                    let event = info.event;

                    let body = '<ul class="list-group list-group-flush">';
                    body += '<li class="list-group-item"><i class="fas fa-user mx-2"></i> ' + event.extendedProps.user_name + '</li>';
                    body += '<li class="list-group-item"><i class="fas fa-pen mx-2"></i> ' + event.title + '</li>';
                    body += '<li class="list-group-item"><i class="fas fa-pen mx-2"></i> ' + event.extendedProps.content + '</li>';
                    body += '<li class="list-group-item"><i class="fas fa-map-marker-alt mx-2"></i> ' + event.extendedProps.location + ', ' +  event.extendedProps.is_national_text + '</li>';
                    body += '<li class="list-group-item"><i class="fas fa-calendar-alt mx-2"></i> ' + event.extendedProps.startStr + '</li>';
                    body += '<li class="list-group-item"><i class="fas fa-calendar-alt mx-2"></i> ' + event.extendedProps.endStr + '</li>';
                    body += '</ul>';

                    $('.offcanvas-title').html(info.event.title);
                    $('.offcanvas-body').html(body);

                    bsOffcanvas.show();
                }
            }).render()
        }

        static init() {
            this.initCalendar()
        }
    }

    One.onLoad((() => e.init()))
}();
